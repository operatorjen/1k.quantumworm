<!DOCTYPE html>
<html lang="en">
  <head>
    <title>work in progress ~ js1024</title>
    <meta name="author" content="author">
    <meta name="description" content="description">
    <meta name="title" content="title">
    <meta charset=utf-8>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body id=b>
    <canvas id=a></canvas>
    <script>
    // Entry configuration
    // ===================

    var title = "Quantum Worm";

    // Shim setup and polyfills (do not edit)
    // ======================================

    a = document.getElementById("a");
    a.width = innerWidth;
    a.height = innerHeight;

    b = document.getElementById("b");

    c = a.getContext("2d");
    d = document;

    var M = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent); // detects if the user is on mobile

    if (M) {
        a.oncontextmenu = function(e) {
                e.preventDefault();
            } // prevents context menu on mobile
    }

    window.AudioContext = window.AudioContext || window.webkitAudioContext;
    window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
    a.requestPointerLock = a.requestPointerLock || a.mozRequestPointerLock || a.webkitRequestPointerLock;
    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
    if (typeof OscillatorNode !== 'undefined' && OscillatorNode.prototype) {
        OscillatorNode.prototype.start = OscillatorNode.prototype.start || OscillatorNode.prototype.noteOn;
        OscillatorNode.prototype.stop = OscillatorNode.prototype.stop || OscillatorNode.prototype.noteOff;
    }

    // Add a start button if sound is present in the code
    onload = () => {
        var entry_code = entry.innerText;
        var has_sound = false;
        if(entry_code.includes('eval')) {
            try {
                parent.eval(entry_code.replace(/eval\(/g, 'throw(').replace(/eval\`/g, 'throw`'));
            }
            catch(e){
                entry_code = e;
            }
        }
        
        try {
        if(entry_code.includes("AudioContext")||entry_code.includes("Oscillator")||entry_code.includes("speak")||entry_code.includes("play")||entry_code.includes("autoplay")){
            b.insertAdjacentHTML("beforeEnd", "<button class='play' onclick='start_demo(this)'>PLAY</button>");
        } else {
            parent.eval(entry.innerText);
        }
        } catch(e) {
            // I have no idea what this does but I think it will make demos that contain eval naturally (no compressor used) work
            entry_code = entry.innerText;
            parent.eval(entry_code);
        }
    };

    // Makes the "window." be optional in the demo code
    function start_demo(button) {
        console.log(entry.innerText);
        parent.eval(entry.innerText);
        button.remove();
    }

    console.log(
        a, // canvas
        b, // body
        c, // 2D canvas context
        d // document
    );
    </script>
    <script id="entry">
      for(_='),_t.^_^ke(jonL=iKraJe=VtylVUr.fillTTSUZj)YY*iX.5*vy",eight0,ate.=.01,Knnerfor(:1+2*Y,+=.3*^v=(^vLresiz0%,^y^xlet ;t--;){r,7_T()=7Mh.	"+h+")"_"hsla("+l.addColorStop(.getCLtext`2d`,,r.beginPh(_r.arc(.width.hi=lWidth,i=lH,t,VMh.Jndom,i=a,hKlK.clLeNodY,r=ly=new ArJy(300_n=[];b.sU"margin: 0i.sU"filter:surj1.5)t=300h=X,a=X;y[t]={i:t,x:h,y:a,vx::a:X*.03,r:.05*i+29*Y,h:140+50*Y}}V()=>Y,functiL a(){Z"rgba(43,99,54,.01)TRect(l,l_t=n.lengthVn[t];+y+=,a-a<=0||y>l?n.splicjt,1):(Zh+64"+a+")"x,y,)}t of y){if(Y<.1&&n.push({x:,y:+^r,ra:1,h:340+30*Y}ki){Vy[^i-1],i=x-,h=y-;^vxx+.1*iky+h)}else ^a+=.6*(Y-.5kvx	cos(^ak	sin(^a);x,y,<0?K:>i&&(=0_<0?K:>i&&(=0);h=.1+.4*(1-^i/299_a=^h,l=r.creeRadialGJdient(,,.2*^r,,,^r);a+871,(a+170)%360+75Zl,,^}h.dJwImagjl,0_requestAnimiLFJmja)}()';G=/[-X-ZT-VJ-Ljk^_]/.exec(_);)with(_.split(G))_=join(shift());eval(_)


    </script>
  </body>
</html>
